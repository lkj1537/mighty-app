<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mighty Master</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');
        body { background-color: #f3f4f6; -webkit-tap-highlight-color: transparent; font-family: 'Pretendard', sans-serif; overflow-y: hidden; }
        [v-cloak] { display: none; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        /* ì •ë³´ ì¹´ë“œ ìŠ¤íƒ€ì¼ */
        .info-card { background: white; border-radius: 12px; padding: 10px; display: flex; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 1px solid #eee; }
    </style>
</head>
<body>
    <div id="app" v-cloak class="max-w-md mx-auto h-[100dvh] bg-gray-50 shadow-xl flex flex-col overflow-hidden relative">
        
        <header class="bg-gray-900 text-white py-3 px-4 text-center shadow-md z-10 shrink-0 flex justify-between items-center">
            <h1 class="text-sm font-black italic tracking-tighter">MIGHTY MASTER</h1>
            <button v-if="step > 2" @click="endGame" class="text-[10px] text-gray-400 font-bold border border-gray-600 px-2 py-1 rounded active:bg-gray-700">ê¸°ë¡ ì´ˆê¸°í™”</button>
        </header>

        <main class="flex-grow p-3 flex flex-col overflow-y-auto">
            
            <section v-if="step === 1" class="flex-grow flex flex-col justify-center space-y-4">
                <button @click="step = 2" class="w-full p-8 rounded-2xl bg-white shadow-sm font-black text-xl text-gray-800 border">ìƒˆ ê²Œì„ ì‹œì‘ ğŸƒ</button>
            </section>

            <section v-if="step === 2" class="flex flex-col h-full space-y-4">
                <h2 class="text-xl font-black">ì¸ì› ì„ íƒ</h2>
                <div class="grid grid-cols-2 gap-2">
                    <button v-for="n in ['í”Œë ˆì´ì–´1','í”Œë ˆì´ì–´2','í”Œë ˆì´ì–´3','í”Œë ˆì´ì–´4','í”Œë ˆì´ì–´5','í”Œë ˆì´ì–´6']" @click="togglePlayer(n)"
                        :class="['p-4 rounded-xl border-2 font-bold', selectedPlayers.includes(n) ? 'border-blue-600 bg-blue-50' : 'bg-white']">{{n}}</button>
                </div>
                <button @click="startGame" :disabled="selectedPlayers.length < 5" class="mt-auto w-full py-4 bg-blue-600 text-white rounded-2xl font-black">ê²Œì„ ì‹œì‘</button>
            </section>

            <section v-if="step === 3" class="flex flex-col h-full space-y-3">
                <div class="flex justify-between items-center px-1">
                    <h2 class="text-sm font-black text-gray-800">Round {{ roundCount }} ì„¤ì •</h2>
                </div>

                <div class="bg-white p-3 rounded-2xl border border-gray-200 shadow-sm">
                    <div class="flex justify-between items-center mb-2">
                        <label class="text-[11px] font-black text-blue-600">ì£¼ê³µ ë° íœ´ì‹ ì„¤ì •</label>
                        <button v-if="players.length === 6" @click="showStandbyModal = true" class="text-[10px] bg-gray-100 px-2 py-1 rounded font-bold">íœ´ì‹: {{standbyPlayer || 'ë¯¸ì§€ì •'}} âš™ï¸</button>
                    </div>
                    <div class="grid grid-cols-3 gap-2">
                        <button v-for="p in players" :key="p.name" @click="selectDealer(p.name)"
                            :disabled="standbyPlayer === p.name"
                            :class="['p-2 rounded-lg border-2 flex flex-col items-center transition-all', 
                                     standbyPlayer === p.name ? 'opacity-30 bg-gray-100' : 
                                     formData.dealer === p.name ? 'border-blue-600 bg-blue-50 text-blue-700' : 'border-gray-100 bg-gray-50']">
                            <span class="text-xs font-bold">{{ p.name }}</span>
                            <span class="text-[10px] opacity-60">{{ p.chips }}</span>
                        </button>
                    </div>
                </div>

                <div class="flex-grow bg-white rounded-2xl border border-gray-200 overflow-hidden flex flex-col p-2">
                    <div class="overflow-y-auto pr-1 flex-grow">
                        <div v-for="s in suits" :key="s.name" class="flex items-center mb-2">
                            <div :class="['w-8 font-black text-lg text-center', s.textColor]">{{ s.symbol }}</div>
                            <div class="flex gap-1 overflow-x-auto hide-scrollbar py-1">
                                <button v-for="num in bids" @click="formData.suit = s.name; formData.bid = num"
                                    :class="['px-3 py-1.5 rounded-full border text-xs font-bold shrink-0', 
                                             formData.suit === s.name && formData.bid === num ? 'bg-gray-800 text-white' : 'bg-white text-gray-400']">
                                    {{num}}
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="pt-2">
                    <button @click="step = 4" :disabled="!isBiddingComplete" 
                        :class="['w-full py-4 rounded-2xl font-black text-sm transition-all shadow-lg', 
                                 isBiddingComplete ? 'bg-blue-600 text-white' : 'bg-gray-200 text-gray-400']">
                        {{ roundStartBtnText }}
                    </button>
                </div>

                <div v-if="showStandbyModal" class="fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-6">
                    <div class="bg-white rounded-3xl w-full p-6">
                        <h3 class="font-black text-center mb-4">ì´ë²ˆ íŒ íœ´ì‹ ì¸ì›</h3>
                        <div class="grid grid-cols-2 gap-2 mb-4">
                            <button v-for="p in players" @click="setStandby(p.name)" class="p-3 border rounded-xl font-bold">{{p.name}}</button>
                        </div>
                        <button @click="showStandbyModal = false" class="w-full py-3 bg-gray-100 rounded-xl font-bold">ë‹«ê¸°</button>
                    </div>
                </div>
            </section>

            <section v-if="step === 4" class="flex flex-col h-full space-y-4">
                <div class="grid grid-cols-2 gap-2">
                    <div class="info-card">
                        <div :class="['text-2xl mr-3', calculateMighty.color.replace('text-', 'text-')]">{{ calculateMighty.symbol }}</div>
                        <div><p class="text-[10px] text-gray-400 font-bold">ë§ˆì´í‹°</p><p class="text-sm font-black">{{ calculateMighty.text }}</p></div>
                    </div>
                    <div class="info-card">
                        <div class="text-2xl mr-3 text-gray-800">â™£ï¸</div>
                        <div><p class="text-[10px] text-gray-400 font-bold">ì¡°ì»¤ ì½œ</p><p class="text-sm font-black">{{ calculateJokerCall.text }}</p></div>
                    </div>
                    <div class="info-card">
                        <div class="text-2xl mr-3 text-amber-500">ğŸ‘‘</div>
                        <div><p class="text-[10px] text-gray-400 font-bold">ì£¼ê³µ</p><p class="text-sm font-black">{{ formData.dealer }} <span class="text-red-500">({{currentSuitSymbol}}{{formData.bid}})</span></p></div>
                    </div>
                    <div class="info-card">
                        <div class="text-2xl mr-3 text-blue-500">ğŸš©</div>
                        <div><p class="text-[10px] text-gray-400 font-bold">ì•¼ë‹¹ ëª©í‘œ</p><p class="text-sm font-black">{{ 21 - formData.bid }}ì¥ ì´ìƒ</p></div>
                    </div>
                </div>

                <div class="flex-grow space-y-4">
                    <div class="bg-white p-4 rounded-2xl border">
                        <label class="block text-xs font-black text-gray-400 mb-2">í”„ë Œë“œ ì§€ì •</label>
                        <div class="grid grid-cols-3 gap-2">
                            <button v-for="p in activePlayers" @click="formData.friend = p.name"
                                :disabled="p.name === formData.dealer"
                                :class="['p-2 border rounded-lg text-sm font-bold', formData.friend === p.name ? 'border-blue-600 bg-blue-50' : 'bg-white']">{{p.name}}</button>
                            <button @click="formData.friend = 'ë…¸í”„ë Œë“œ'" :class="['p-2 border rounded-lg text-sm font-bold', formData.friend === 'ë…¸í”„ë Œë“œ' ? 'bg-red-50 border-red-200' : '']">ë…¸í”„ë Œë“œ</button>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl border text-center">
                        <p class="text-xs font-black text-gray-400 mb-4">ì•¼ë‹¹ íšë“ ì¥ìˆ˜: <span class="text-2xl text-gray-800">{{formData.oppScore}}</span></p>
                        <input type="range" v-model.number="formData.oppScore" min="0" max="20" class="w-full h-2 bg-gray-200 rounded-lg appearance-none accent-blue-600">
                    </div>
                </div>

                <button @click="calculateResult" :disabled="!formData.friend" class="w-full py-4 bg-gray-900 text-white rounded-2xl font-black shadow-xl">ê²°ê³¼ ì •ì‚°í•˜ê¸°</button>
            </section>

            <section v-if="step === 5" class="flex flex-col h-full items-center justify-center">
                <h2 class="text-3xl font-black mb-8">ì •ì‚° ì™„ë£Œ</h2>
                <button @click="nextRound" class="w-full py-4 bg-blue-600 text-white rounded-2xl font-black">ë‹¤ìŒ ë¼ìš´ë“œ</button>
            </section>

        </main>
    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    step: 1, selectedPlayers: [], players: [], standbyPlayer: null, showStandbyModal: false,
                    roundCount: 1, suits: [
                        { symbol: 'N', name: 'ë…¸ê¸°ë£¨', textColor: 'text-gray-400' },
                        { symbol: 'â™ ', name: 'ìŠ¤í˜ì´ë“œ', textColor: 'text-gray-900' },
                        { symbol: 'â™¦', name: 'ë‹¤ì´ì•„', textColor: 'text-red-600' },
                        { symbol: 'â™£', name: 'í´ë¡œë²„', textColor: 'text-gray-900' },
                        { symbol: 'â™¥', name: 'í•˜íŠ¸', textColor: 'text-red-600' }
                    ],
                    bids: [13, 14, 15, 16, 17, 18, 19, 20],
                    formData: { dealer: '', friend: '', suit: null, bid: null, oppScore: 0 }
                }
            },
            computed: {
                // [ë¡œì§] ë²„íŠ¼ í…ìŠ¤íŠ¸ë¥¼ ë™ì ìœ¼ë¡œ ìƒì„±
                roundStartBtnText() {
                    let missing = [];
                    if (this.selectedPlayers.length === 6 && !this.standbyPlayer) missing.push('íœ´ì‹');
                    if (!this.formData.dealer) missing.push('ì£¼ê³µ');
                    if (!this.formData.suit || !this.formData.bid) missing.push('ë¹„ë”©');

                    if (missing.length === 0) return "ë¼ìš´ë“œ ì‹œì‘";
                    return `ë¼ìš´ë“œ ì‹œì‘ (${missing.join(', ')})`;
                },
                isBiddingComplete() {
                    return this.formData.dealer && this.formData.suit && this.formData.bid && (this.selectedPlayers.length !== 6 || this.standbyPlayer);
                },
                activePlayers() { return this.players.filter(p => p.name !== this.standbyPlayer); },
                calculateMighty() {
                    if (!this.formData.suit) return { text: '-', color: 'text-gray-300', symbol: '?' };
                    const isSpade = this.formData.suit === 'ìŠ¤í˜ì´ë“œ';
                    return isSpade ? { text: 'ë‹¤ì´ì•„ A', color: 'text-red-600', symbol: 'â™¦ï¸' } : { text: 'ìŠ¤í˜ì´ë“œ A', color: 'text-gray-900', symbol: 'â™ ï¸' };
                },
                calculateJokerCall() {
                    if (!this.formData.suit) return { text: '-' };
                    return this.formData.suit === 'í´ë¡œë²„' ? { text: 'ìŠ¤í˜ì´ë“œ 3' } : { text: 'í´ë¡œë²„ 3' };
                },
                currentSuitSymbol() {
                    return this.suits.find(s => s.name === this.formData.suit)?.symbol || '';
                }
            },
            methods: {
                togglePlayer(name) {
                    const idx = this.selectedPlayers.indexOf(name);
                    idx > -1 ? this.selectedPlayers.splice(idx, 1) : this.selectedPlayers.push(name);
                },
                startGame() {
                    this.players = this.selectedPlayers.map(name => ({ name, chips: 40 }));
                    this.step = 3;
                },
                selectDealer(name) { this.formData.dealer = name; },
                setStandby(name) { this.standbyPlayer = name; this.showStandbyModal = false; },
                calculateResult() { this.step = 5; },
                nextRound() { 
                    this.roundCount++; 
                    this.formData = { dealer: '', friend: '', suit: null, bid: null, oppScore: 0 };
                    this.step = 3; 
                },
                endGame() { this.step = 1; this.selectedPlayers = []; }
            }
        }).mount('#app')
    </script>
</body>
</html>